package hai.payment.dynamodb_access;

import com.amazonaws.auth.AWSCredentials;
import com.amazonaws.auth.profile.ProfileCredentialsProvider;
import com.amazonaws.services.dynamodbv2.AmazonDynamoDBClient;
import com.amazonaws.services.dynamodbv2.document.DeleteItemOutcome;
import com.amazonaws.services.dynamodbv2.document.DynamoDB;
import com.amazonaws.services.dynamodbv2.document.Table;
import com.amazonaws.services.dynamodbv2.document.spec.DeleteItemSpec;
import com.amazonaws.services.dynamodbv2.document.utils.NameMap;
import com.amazonaws.services.dynamodbv2.document.utils.ValueMap;
import com.amazonaws.services.dynamodbv2.model.ReturnValue;

import hai.payment.common.DynamoUtil;
import hai.payment.model.PaymentPto;

public class PaymentRepository {
	DynamoDB dynamoDB;
	AWSCredentials credentials = null;
	static String _tableName = "Payment";
	void init()
	{
		try {
			credentials = new ProfileCredentialsProvider().getCredentials();
			AmazonDynamoDBClient client = new AmazonDynamoDBClient();
			client.withEndpoint("http://localhost:8000"); 	
			dynamoDB = new DynamoDB(client);

		} catch (Exception e) {
			System.err.println("Program failed:");
			System.err.println(e.getMessage());
		}
		
	}
	public void createTable()
	{

		try {
			init();
			DynamoUtil u =  new DynamoUtil(dynamoDB); 
			u.createTable(_tableName,10L, 5L, "userId", "N","paidDatetime","S");

		} catch (Exception e) {
			System.err.println("Program failed:");
			System.err.println(e.getMessage());
		}
	}
	public void insertItem(PaymentPto paymentPto )
	{
		Table table = dynamoDB.getTable(_tableName);
		
	}
	public  void getAll()
	{
		
		
	}
}
