package db_pkg;

import java.text.SimpleDateFormat;
import java.util.HashMap;
import java.util.Map;

import com.amazonaws.auth.AWSCredentials;
import com.amazonaws.auth.profile.ProfileCredentialsProvider;
import com.amazonaws.services.dynamodbv2.AmazonDynamoDBClient;
import com.amazonaws.services.dynamodbv2.document.DynamoDB;
import com.amazonaws.services.dynamodbv2.document.Table;
import com.amazonaws.services.dynamodbv2.document.UpdateItemOutcome;
import com.amazonaws.services.dynamodbv2.document.spec.UpdateItemSpec;
import com.amazonaws.services.dynamodbv2.document.utils.NameMap;
import com.amazonaws.services.dynamodbv2.document.utils.ValueMap;
import com.amazonaws.services.dynamodbv2.model.ReturnValue;

public class Example3Add {
	static DynamoDB dynamoDB = new DynamoDB(new AmazonDynamoDBClient());
	static SimpleDateFormat dateFormatter = new SimpleDateFormat(
			"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'");

	static String productCatalogTableName = "ProductCatalog";
	static String forumTableName = "Forum";
	static String threadTableName = "Thread";
	static String replyTableName = "Reply";

	public static void main(String[] args) throws Exception {

		updateTables();
	}

	private static void updateTables()
	{
		AWSCredentials credentials = null;
		try {
			credentials = new ProfileCredentialsProvider().getCredentials();
			AmazonDynamoDBClient client = new AmazonDynamoDBClient();
			client.withEndpoint("http://localhost:8000"); 	
			dynamoDB = new DynamoDB(client);
			
	        final Map<String, Object> infoMap = new HashMap<String, Object>();
	        infoMap.put("plot",  "Nothing happens at all.");
	        infoMap.put("rating",  0);

			Table table = dynamoDB.getTable(tableName);
			UpdateItemOutcome outcome =  table.updateItem(updateItemSpec);

			// Check the response.
			System.out.println("Printing item after adding new attribute...");
			System.out.println(outcome.getItem().toJSONPretty());    


		} catch (Exception e) {
			System.err.println("Program failed:");
			System.err.println(e.getMessage());
		}
	}
}
