package db_pkg;

import java.text.SimpleDateFormat;
import java.util.Arrays;
import java.util.Date;
import java.util.HashSet;

import com.amazonaws.auth.AWSCredentials;
import com.amazonaws.auth.profile.ProfileCredentialsProvider;
import com.amazonaws.services.dynamodbv2.AmazonDynamoDBClient;
import com.amazonaws.services.dynamodbv2.document.DynamoDB;
import com.amazonaws.services.dynamodbv2.document.Item;
import com.amazonaws.services.dynamodbv2.document.Table;

public class Example4Delete {
	static DynamoDB dynamoDB;
	static SimpleDateFormat dateFormatter = new SimpleDateFormat(
			"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'");
	
	public static void main(String[] args) {
		// TODO Auto-generated method stub

	}
	private static void DeleteThread()
	{
		AWSCredentials credentials = null;
		try {
			credentials = new ProfileCredentialsProvider().getCredentials();
			AmazonDynamoDBClient client = new AmazonDynamoDBClient();
			client.withEndpoint("http://localhost:8000"); 	
			dynamoDB = new DynamoDB(client);
			Table table = dynamoDB.getTable("Thread");
			Date date2 = new Date();
			long time2 = (new Date()).getTime() - (14 * 24 * 60 * 60 * 1000); // 14
			date2.setTime(time2);
			Item item = new Item()
					.withPrimaryKey("ForumName", "My forum")
					.withString("Subject", "Subject 1")
					.withString("Message", "DynamoDB thread 1 message")
					.withString("LastPostedBy", "User H")
					.withString("LastPostedDateTime", dateFormatter.format(date2))
					.withNumber("Views", 0)
					.withNumber("Replies", 0)
					.withNumber("Answered", 0)
					.withStringSet( "Tags", new HashSet<String>(
							Arrays.asList("index", "primarykey", "table")));
			table.putItem(item);
			
			loadSampleThreads("Thread");
			System.err.println("Success.");     

		} catch (Exception e) {
			System.err.println("Program failed:");
			System.err.println(e.getMessage());
		}
	}
}
