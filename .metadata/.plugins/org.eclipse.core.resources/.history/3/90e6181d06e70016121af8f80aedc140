package db_pkg;

import java.text.SimpleDateFormat;
import java.util.Arrays;
import java.util.Date;
import java.util.HashSet;

import com.amazonaws.auth.AWSCredentials;
import com.amazonaws.auth.profile.ProfileCredentialsProvider;
import com.amazonaws.services.dynamodbv2.AmazonDynamoDBClient;
import com.amazonaws.services.dynamodbv2.document.DynamoDB;
import com.amazonaws.services.dynamodbv2.document.Item;
import com.amazonaws.services.dynamodbv2.document.Table;

public class Example4Delete {
	static DynamoDB dynamoDB;
	static SimpleDateFormat dateFormatter = new SimpleDateFormat(
			"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'");
	
	public static void main(String[] args) {
		// TODO Auto-generated method stub

	}
	private static void DeleteThread()
	{
		AWSCredentials credentials = null;
		try {
			credentials = new ProfileCredentialsProvider().getCredentials();
			AmazonDynamoDBClient client = new AmazonDynamoDBClient();
			client.withEndpoint("http://localhost:8000"); 	
			dynamoDB = new DynamoDB(client);
			
			Table table = dynamoDB.getTable("Thread");
			DeleteItemSpec deleteItemSpec = new DeleteItemSpec()
		            .withPrimaryKey("Id", 120)
		            .withConditionExpression("#ip = :val")
		            .withNameMap(new NameMap()
		                .with("#ip", "InPublication"))
		            .withValueMap(new ValueMap()
		            .withBoolean(":val", false))
		            .withReturnValues(ReturnValue.ALL_OLD);

		            DeleteItemOutcome outcome = table.deleteItem(deleteItemSpec)
			System.err.println("Success.");     

		} catch (Exception e) {
			System.err.println("Program failed:");
			System.err.println(e.getMessage());
		}
	}
}
